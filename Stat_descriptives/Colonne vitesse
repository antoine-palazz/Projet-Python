###############################################
#  Impact relatif de la météo sur la vitesse  #
###############################################

import pandas as pd

def calculer_vitesse(dataframe):
    if 'TotalSeconds' not in dataframe.columns or 'Distance (km)' not in dataframe.columns:
        raise ValueError("Le dataframe doit avoir des colonnes 'TotalSeconds' et 'Distance (km)'.")

    # Calculer la vitesse en km/h
    dataframe['Vitesse (km/h)'] = (dataframe['Distance (km)'] / dataframe['TotalSeconds']) * 3600

    return dataframe

moyenne_par_categorie = donnees.groupby('meteo_categorie')['Vitesse (km/h)'].mean().reset_index()
#Catégories mentionnées : Categorie_Beau_Temps;Categorie_Pluvieux;Categorie_venteux;Categorie_Caniculaire;Categorie_Changeant

# Sélectionner la référence (dans ce cas, "beau" temps)
reference = moyenne_par_categorie[moyenne_par_categorie['meteo_categorie'] == 'Categorie_Beau_Temps']['Vitesse (km/h)'].iloc[0]

# Calculer l'impact relatif de chaque catégorie par rapport à la référence
moyenne_par_categorie['impact_relatif'] = moyenne_par_categorie['Vitesse (km/h)'] / reference

print(moyenne_par_categorie)

